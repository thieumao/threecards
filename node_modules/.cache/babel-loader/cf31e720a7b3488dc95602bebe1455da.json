{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import Screen from'../Screen';import React,{useState,useEffect}from'react';import{FlatList}from'react-native';import styled from'styled-components/native';import{useParams}from'react-router-dom';import textAPI from'api/textAPI';import CryptoJS from'crypto-js';import Part1Item from'./shared/Part1Item';import Footer from'components/Footer';import{getPart}from'store/selectors/selectors';import{updatePartAction}from'store/actionTypes/actionType';import{useDispatch,useSelector}from'react-redux';var TestFlatList=styled(FlatList)(_templateObject());var Part1=function Part1(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),testList=_useState2[0],setTestList=_useState2[1];var _useState3=useState(-1),_useState4=_slicedToArray(_useState3,2),correctNumber=_useState4[0],setCorrectNumber=_useState4[1];var _useState5=useState(-1),_useState6=_slicedToArray(_useState5,2),totalNumber=_useState6[0],setTotalNumber=_useState6[1];var dispatch=useDispatch();var _useParams=useParams(),testNumber=_useParams.testNumber;var testName=\"test\".concat(testNumber);var part=useSelector(getPart(testName,'part1'));useEffect(function(){getData(testNumber,part);},[]);var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(testNumber,part){var itemTypes,data,plainData,json;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:itemTypes=part&&part.questions&&part.questions.length>0?part.questions:[];if(!(itemTypes.length>0)){_context.next=5;break;}setTestList(itemTypes);_context.next=12;break;case 5:_context.next=7;return textAPI.get(testNumber,1);case 7:data=_context.sent;plainData=CryptoJS.AES.decrypt(data,'thieumao').toString(CryptoJS.enc.Utf8);json=JSON.parse(plainData);setTestList(json);updateDatabase(testName,json);case 12:case\"end\":return _context.stop();}}},_callee);}));return function getData(_x,_x2){return _ref.apply(this,arguments);};}();var updateDatabase=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(testName,partQuestions){var partDetail;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:partDetail={name:'Part 1',questions:partQuestions};dispatch(updatePartAction(testName,'part1',partDetail));case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function updateDatabase(_x3,_x4){return _ref2.apply(this,arguments);};}();var selectAnswer=function selectAnswer(item,index,selected){var arr=testList||[];if(arr[index].selected!=selected){arr[index].selected=selected;}else{arr[index].selected=undefined;}updateDatabase(testName,arr);};var onReset=function onReset(){var arr=testList||[];var _iterator=_createForOfIteratorHelper(arr),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;item.submitted=false;item.selected=undefined;}}catch(err){_iterator.e(err);}finally{_iterator.f();}updateDatabase(testName,arr);setCorrectNumber(-1);};var onSubmit=function onSubmit(){calculateScore();var arr=testList||[];var _iterator2=_createForOfIteratorHelper(arr),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var item=_step2.value;if(item.selected){item.submitted=true;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}updateDatabase(testName,arr);};var calculateScore=function calculateScore(){var correctCount=0;var count=0;var _iterator3=_createForOfIteratorHelper(testList),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var item=_step3.value;count+=1;if(item.selected){if(item.selected==item.correct){// correct\ncorrectCount+=1;}else{// incorrect\n}}else{// not choose\n}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}setCorrectNumber(correctCount);setTotalNumber(count);};var renderItem=function renderItem(_ref3){var index=_ref3.index;var item=testList[index];return/*#__PURE__*/React.createElement(Part1Item,{item:item,index:index,testNumber:testNumber,onClick:selectAnswer});};return/*#__PURE__*/React.createElement(Screen,{canBack:true,title:\"Test \".concat(testNumber,\" - Part 1\"),showMenu:false},/*#__PURE__*/React.createElement(TestFlatList,{data:testList,renderItem:renderItem,keyExtractor:function keyExtractor(item,index){return\"\".concat(index,\"_\").concat(item);}}),/*#__PURE__*/React.createElement(Footer,{correctNumber:correctNumber,totalNumber:totalNumber,onReset:onReset,onSubmit:onSubmit}));};export default Part1;","map":{"version":3,"sources":["/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/src/containers/Part1/index.tsx"],"names":["Screen","React","useState","useEffect","FlatList","styled","useParams","textAPI","CryptoJS","Part1Item","Footer","getPart","updatePartAction","useDispatch","useSelector","TestFlatList","Part1","testList","setTestList","correctNumber","setCorrectNumber","totalNumber","setTotalNumber","dispatch","testNumber","testName","part","getData","itemTypes","questions","length","get","data","plainData","AES","decrypt","toString","enc","Utf8","json","JSON","parse","updateDatabase","partQuestions","partDetail","name","selectAnswer","item","index","selected","arr","undefined","onReset","submitted","onSubmit","calculateScore","correctCount","count","correct","renderItem"],"mappings":"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","sourcesContent":["import Screen from '../Screen';\nimport React, { FC, useState, useEffect } from 'react';\nimport { FlatList } from 'react-native';\nimport styled from 'styled-components/native';\nimport { useParams } from 'react-router-dom';\nimport textAPI from 'api/textAPI';\nimport CryptoJS from 'crypto-js';\nimport Part1Item from './shared/Part1Item';\nimport Footer from 'components/Footer';\nimport { getPart } from 'store/selectors/selectors';\nimport { updatePartAction } from 'store/actionTypes/actionType';\nimport { useDispatch, useSelector } from 'react-redux';\n\nconst TestFlatList = styled(FlatList as new () => FlatList<string>)`\n  width: 100%;\n  height: 100%;\n`;\n\nconst Part1: FC = () => {\n  const [testList, setTestList] = useState<any[]>([]);\n  const [correctNumber, setCorrectNumber] = useState<number>(-1);\n  const [totalNumber, setTotalNumber] = useState<number>(-1);\n\n  const dispatch = useDispatch();\n  const { testNumber } = useParams();\n  const testName = `test${testNumber}`;\n  const part  = useSelector(getPart(testName, 'part1'));\n  useEffect(() => {\n    getData(testNumber, part);\n  }, []);\n\n  const getData = async (testNumber: number, part: any) => {\n    const itemTypes: any[] = (part && part.questions && part.questions.length > 0) ? part.questions : [];\n    if (itemTypes.length > 0) {\n      setTestList(itemTypes);\n    } else {\n      const data = await textAPI.get(testNumber, 1);\n      const plainData = CryptoJS.AES.decrypt(data, 'thieumao').toString(CryptoJS.enc.Utf8);\n      const json = JSON.parse(plainData);\n      setTestList(json);\n      updateDatabase(testName, json);\n    }\n  };\n\n  const updateDatabase = async (testName: string, partQuestions: any[]) => {\n    const partDetail = {\n      name: 'Part 1',\n      questions: partQuestions,\n    };\n    dispatch(updatePartAction(testName, 'part1', partDetail));\n  };\n\n  const selectAnswer = (item: any, index: number, selected: string) => {\n    let arr = testList || [];\n    if (arr[index].selected != selected) {\n      arr[index].selected = selected;\n    } else {\n      arr[index].selected = undefined;\n    }\n    updateDatabase(testName, arr);\n  };\n\n  const onReset = () => {\n    let arr = testList || [];\n    for (let item of arr) {\n      item.submitted = false;\n      item.selected = undefined;\n    }\n    updateDatabase(testName, arr);\n\n    setCorrectNumber(-1);\n  };\n\n  const onSubmit = () => {\n    calculateScore();\n    let arr = testList || [];\n    for (let item of arr) {\n      if (item.selected) {\n        item.submitted = true;\n      }\n    }\n    updateDatabase(testName, arr);\n  };\n\n  const calculateScore = () => {\n    let correctCount = 0;\n    let count = 0;\n    for (const item of testList) {\n      count += 1;\n      if (item.selected) {\n        if (item.selected == item.correct) {\n          // correct\n          correctCount += 1;\n        } else {\n          // incorrect\n        }\n      } else {\n        // not choose\n      }\n    }\n    setCorrectNumber(correctCount);\n    setTotalNumber(count);\n  };\n\n  const renderItem = ({ index }: { item; index }) => {\n    const item = testList[index];\n    return (\n      <Part1Item\n        item={item}\n        index={index}\n        testNumber={testNumber}\n        onClick={selectAnswer}\n      />\n    );\n  };\n\n  return (\n      <Screen canBack title={`Test ${testNumber} - Part 1`} showMenu={false}>\n        <TestFlatList\n          data={testList}\n          renderItem={renderItem}\n          keyExtractor={(item, index) => `${index}_${item}`}\n        />\n        <Footer correctNumber={correctNumber} totalNumber={totalNumber} onReset={onReset} onSubmit={onSubmit} />\n      </Screen>\n  );\n};\n\nexport default Part1;\n"]},"metadata":{},"sourceType":"module"}