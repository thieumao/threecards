{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import Screen from'../Screen';import React,{useState,useEffect}from'react';import{FlatList}from'react-native';import styled from'styled-components/native';import{useParams}from'react-router-dom';import textAPI from\"../../api/textAPI\";import CryptoJS from'crypto-js';import Part7Item from'./shared/Part7Item';import Footer from'components/Footer';import{getPart}from'store/selectors/selectors';import{updatePartAction}from'store/actionTypes/actionType';import{useDispatch,useSelector}from'react-redux';var TestFlatList=styled(FlatList)(_templateObject());var Part7=function Part7(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),testList=_useState2[0],setTestList=_useState2[1];var _useState3=useState(-1),_useState4=_slicedToArray(_useState3,2),correctNumber=_useState4[0],setCorrectNumber=_useState4[1];var _useState5=useState(-1),_useState6=_slicedToArray(_useState5,2),totalNumber=_useState6[0],setTotalNumber=_useState6[1];var dispatch=useDispatch();var _useParams=useParams(),testNumber=_useParams.testNumber;var testName=\"test\".concat(testNumber);var part7=useSelector(getPart(testName,'part7'));useEffect(function(){getData(testNumber,part7);},[]);var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(testNumber,part7){var itemTypes,data,plainData,json;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:itemTypes=part7&&part7.questions&&part7.questions.length>0?part7.questions:[];if(!(itemTypes.length>0)){_context.next=5;break;}setTestList(itemTypes);_context.next=12;break;case 5:_context.next=7;return textAPI.get(testNumber,7);case 7:data=_context.sent;plainData=CryptoJS.AES.decrypt(data,'thieumao').toString(CryptoJS.enc.Utf8);json=JSON.parse(plainData);setTestList(json);updateDatabase(testName,json);case 12:case\"end\":return _context.stop();}}},_callee);}));return function getData(_x,_x2){return _ref.apply(this,arguments);};}();var updateDatabase=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(testName,part7Questions){var part7Detail;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:part7Detail={name:'Part 7',questions:part7Questions};dispatch(updatePartAction(testName,'part7',part7Detail));case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function updateDatabase(_x3,_x4){return _ref2.apply(this,arguments);};}();var onReset=function onReset(){var arr=testList||[];var _iterator=_createForOfIteratorHelper(arr),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var test=_step.value;test.isShownTranslate=false;var questions=test.questions?test.questions:[];var _iterator2=_createForOfIteratorHelper(questions),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var question=_step2.value;var item=question;if(item){item.submitted=false;item.selected=false;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}catch(err){_iterator.e(err);}finally{_iterator.f();}updateDatabase(testName,arr);setCorrectNumber(-1);};var onSubmit=function onSubmit(){calculateScore();var arr=testList||[];var _iterator3=_createForOfIteratorHelper(arr),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var test=_step3.value;var questions=test.questions?test.questions:[];var _iterator4=_createForOfIteratorHelper(questions),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var question=_step4.value;var item=question;if(item&&item.selected){test.isShownTranslate=true;item.submitted=true;}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}updateDatabase(testName,arr);};var calculateScore=function calculateScore(){var wrongCount=0;var correctCount=0;var count=0;var _iterator5=_createForOfIteratorHelper(testList),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var test=_step5.value;var questions=test.questions?test.questions:[];var allNone=true;var allCorrect=true;var _iterator6=_createForOfIteratorHelper(questions),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var question=_step6.value;count+=1;var item=question;if(item&&item.selected){if(item.selected==item.correct){correctCount+=1;allNone=false;}else{wrongCount+=1;allCorrect=false;allNone=false;}}else{allCorrect=false;}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}setCorrectNumber(correctCount);setTotalNumber(count);};var onSelectAnswer=function onSelectAnswer(detailItem,questionPosition,selected,part7Index){var arr=testList||[];if(arr[part7Index].questions[questionPosition].selected!=selected){arr[part7Index].questions[questionPosition].selected=selected;}else{arr[part7Index].questions[questionPosition].selected=undefined;}updateDatabase(testName,arr);};var renderItem=function renderItem(_ref3){var index=_ref3.index;var item=testList[index];return/*#__PURE__*/React.createElement(Part7Item,{data:item,part7Index:index,visibleIndex:1,onSelectAnswer:onSelectAnswer,onCollapse:function onCollapse(){return null;},onCollapseTranslation:function onCollapseTranslation(){return null;}});};return/*#__PURE__*/React.createElement(Screen,{canBack:true,title:\"Test \".concat(testNumber,\" - Part 7\"),showMenu:false},/*#__PURE__*/React.createElement(TestFlatList,{data:testList,renderItem:renderItem,keyExtractor:function keyExtractor(item,index){return\"\".concat(index,\"_\").concat(item);}}),/*#__PURE__*/React.createElement(Footer,{correctNumber:correctNumber,totalNumber:totalNumber,onReset:onReset,onSubmit:onSubmit}));};export default Part7;","map":{"version":3,"sources":["/Users/thieunguyen/Desktop/Project/ReactJS/web-ets-2020/src/containers/Part7/index.tsx"],"names":["Screen","React","useState","useEffect","FlatList","styled","useParams","textAPI","CryptoJS","Part7Item","Footer","getPart","updatePartAction","useDispatch","useSelector","TestFlatList","Part7","testList","setTestList","correctNumber","setCorrectNumber","totalNumber","setTotalNumber","dispatch","testNumber","testName","part7","getData","itemTypes","questions","length","get","data","plainData","AES","decrypt","toString","enc","Utf8","json","JSON","parse","updateDatabase","part7Questions","part7Detail","name","onReset","arr","test","isShownTranslate","question","item","submitted","selected","onSubmit","calculateScore","wrongCount","correctCount","count","allNone","allCorrect","correct","onSelectAnswer","detailItem","questionPosition","part7Index","undefined","renderItem","index"],"mappings":"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","sourcesContent":["import Screen from '../Screen';\nimport React, { FC, useState, useEffect } from 'react';\nimport { FlatList } from 'react-native';\nimport styled from 'styled-components/native';\nimport { useParams } from 'react-router-dom';\nimport textAPI from \"../../api/textAPI\";\nimport CryptoJS from 'crypto-js';\nimport Part7Item from './shared/Part7Item';\nimport Footer from 'components/Footer';\nimport { getPart } from 'store/selectors/selectors';\nimport { updatePartAction } from 'store/actionTypes/actionType';\nimport { useDispatch, useSelector } from 'react-redux';\n\nconst TestFlatList = styled(FlatList as new () => FlatList<string>)`\n  width: 100%;\n  height: 100%;\n`;\n\nconst Part7: FC = () => {\n  const [testList, setTestList] = useState<any[]>([]);\n  const [correctNumber, setCorrectNumber] = useState<number>(-1);\n  const [totalNumber, setTotalNumber] = useState<number>(-1);\n\n  const dispatch = useDispatch();\n  const { testNumber } = useParams();\n  const testName = `test${testNumber}`;\n  const part7  = useSelector(getPart(testName, 'part7'));\n  useEffect(() => {\n    getData(testNumber, part7);\n  }, []);\n\n  const getData = async (testNumber: number, part7: any) => {\n    const itemTypes: any[] = (part7 && part7.questions && part7.questions.length > 0) ? part7.questions : [];\n    if (itemTypes.length > 0) {\n      setTestList(itemTypes);\n    } else {\n      const data = await textAPI.get(testNumber, 7);\n      const plainData = CryptoJS.AES.decrypt(data, 'thieumao').toString(CryptoJS.enc.Utf8);\n      const json = JSON.parse(plainData);\n      setTestList(json);\n      updateDatabase(testName, json);\n    }\n  };\n\n  const updateDatabase = async (testName: string, part7Questions: any[]) => {\n    const part7Detail = {\n      name: 'Part 7',\n      questions: part7Questions,\n    };\n    dispatch(updatePartAction(testName, 'part7', part7Detail));\n  };\n\n  const onReset = () => {\n    let arr = testList || [];\n    for (let test of arr) {\n      test.isShownTranslate = false;\n      const questions = (test.questions) ? test.questions : [];\n      for (const question of questions) {\n        const item = question;\n        if (item) {\n          item.submitted = false;\n          item.selected = false;\n        }\n      }\n    }\n    updateDatabase(testName, arr);\n\n    setCorrectNumber(-1);\n  };\n\n  const onSubmit = () => {\n    calculateScore();\n    let arr = testList || [];\n    for (let test of arr) {\n      const questions = (test.questions) ? test.questions : [];\n      for (const question of questions) {\n        const item = question;\n        if (item && item.selected) {\n          test.isShownTranslate = true;\n          item.submitted = true;\n        }\n      }\n    }\n    updateDatabase(testName, arr);\n  };\n\n  const calculateScore = () => {\n    let wrongCount = 0;\n    let correctCount = 0;\n    let count = 0;\n    for (const test of testList) {\n      const questions = (test.questions) ? test.questions : []; \n      let allNone = true;\n      let allCorrect = true;\n      for (const question of questions) {\n        count += 1;\n        const item = question;\n        if (item && item.selected) {\n          if (item.selected == item.correct) {\n            correctCount += 1;\n            allNone = false;\n          } else {\n            wrongCount += 1;\n            allCorrect = false;\n            allNone = false;\n          }\n        } else {\n          allCorrect = false;\n        }\n      }\n    }\n    setCorrectNumber(correctCount);\n    setTotalNumber(count);\n  };\n\n  const onSelectAnswer = (detailItem: any, questionPosition: number, selected: string, part7Index: number) => {\n    let arr = testList || [];\n    if (arr[part7Index].questions[questionPosition].selected != selected) {\n      arr[part7Index].questions[questionPosition].selected = selected;\n    } else {\n      arr[part7Index].questions[questionPosition].selected = undefined;\n    }\n    updateDatabase(testName, arr);\n  };\n\n  const renderItem = ({ index }: { item: any; index: number }) => {\n    const item = testList[index];\n    return (\n      <Part7Item\n        data={item}\n        part7Index={index}\n        visibleIndex={1}\n        onSelectAnswer={onSelectAnswer}\n        onCollapse={() => null}\n        onCollapseTranslation={() => null}\n      />\n    );\n  };\n\n  return (\n      <Screen canBack title={`Test ${testNumber} - Part 7`} showMenu={false}>\n        <TestFlatList\n          data={testList}\n          renderItem={renderItem}\n          keyExtractor={(item, index) => `${index}_${item}`}\n        />\n        <Footer correctNumber={correctNumber} totalNumber={totalNumber} onReset={onReset} onSubmit={onSubmit} />\n      </Screen>\n  );\n};\n\nexport default Part7;\n"]},"metadata":{},"sourceType":"module"}